name: Jekyll Site Build and Deploy

# å½“ä»£ç æ¨é€åˆ° 'main' åˆ†æ”¯æ—¶è¿è¡Œæ­¤å·¥ä½œæµ
on:
  push:
    branches:
      - main  # ç¡®ä¿è¿™é‡Œæ˜¯ä½ çš„ä¸»è¦å‘å¸ƒåˆ†æ”¯ (é€šå¸¸æ˜¯ main æˆ– master)

# å…è®¸ GitHub Actions ç¼–è¾‘ pages
permissions:
  contents: read
  pages: write
  id-token: write

jobs:
  build_and_deploy:
    runs-on: ubuntu-latest
    
    steps:
      - name: â¬‡ï¸ Checkout code
        uses: actions/checkout@v4
        with:
          lfs: true # å¦‚æœä½ æœ‰å¤§æ–‡ä»¶æ”¯æŒï¼Œè¿™æ˜¯æ¨èè®¾ç½®

      - name: ğŸ› ï¸ Setup Ruby and Gems
        uses: actions/setup-ruby@v1
        with:
          ruby-version: '3.x' # ç¡®ä¿ä½¿ç”¨è¾ƒæ–°çš„ Ruby ç‰ˆæœ¬
          
      - name: ğŸ“¦ Install Jekyll Dependencies
        # å®‰è£…ä½ çš„ Gemfile ä¸­å®šä¹‰çš„ä¾èµ–
        run: |
          gem install bundler 
          bundle config path vendor/bundle
          bundle install --jobs 4 --retry 3

      - name: âš™ï¸ Build Jekyll site
        # ä½¿ç”¨ bundler è¿è¡Œ Jekyll build å‘½ä»¤
        run: bundle exec jekyll build

      - name: ğŸ“‚ Upload Pages artifact
        uses: actions/upload-pages-artifact@v3
        with:
          path: ./_site # Jekyll é»˜è®¤çš„æ„å»ºè¾“å‡ºç›®å½•

      - name: ğŸš€ Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4
